<div class="approval-code-parent" xmlns="http://www.w3.org/1999/html">
    <div>
        <p>
            <input id="accessCode" placeholder="Enter Pre-Approval Code"/>
            <picture>
                <source type="image/webp" srcset="images/button.webp">
                <img alt="button" src="images/button.png" id="submit-button">
            </picture>
            
        </p>

        <p>Don't have your code, <span class="approval-code-parent-link" id="submit-link">click here</span>.</p>
        <p>
            <button id="submit-apply-now" type="button">Apply Now</button>
        </p>
    </div>
</div>

<script type="text/javascript" asp-add-nonce="true">
window.addEventListener("load", function () {
 $(document).ready(function(){
             document.getElementById("submit-button").disabled = false;
             $(".approval-code-parent img").css("filter","grayscale(0)");
             document.getElementById("submit-link").disabled = false;
             $(".approval-code-parent button").css("filter","grayscale(0)");
             document.getElementById("submit-apply-now").disabled = false;
             $(".approval-code-parent-link").css("filter","grayscale(0)");
             
         $("#submit-button").click(submitCode);
         $("#submit-link").click(submitCode);
         $("#submit-apply-now").click(submitCode);
            $('input').keyup(function(event) {
                        if (event.which === 13)
                        {
                            event.preventDefault();
                            submitCode();
                        }
                    });      
         
    });
});

function submitCode() {
        document.getElementById("submit-button").disabled = true;
        $(".approval-code-parent img").css("filter","grayscale(100%)");
        document.getElementById("submit-link").disabled = true;
        $(".approval-code-parent button").css("filter","grayscale(100%)");
        document.getElementById("submit-apply-now").disabled = true;
        $(".approval-code-parent-link").css("filter","grayscale(100%)");
        fhToastr.info("Applying, please wait ...");
        var accessCode = $('#accessCode').val().toUpperCase();
        var referer = window.frames.top.document.referrer;
      
        var myUrlAction = '@Html.Raw(@Url.Action("SubmitCode", "Home", new { accessCode = "_accessCode_", referer = "_referer_" }))';
        myUrlAction = myUrlAction.replace("_accessCode_", accessCode);
        myUrlAction = myUrlAction.replace("_referer_", referer);
        window.open(myUrlAction, "_self");
    }
   
</script>

<style asp-add-nonce="true">
    .approval-code-parent {
        display: grid;
        grid-template-columns: 1fr;
        grid-template-rows: 1fr;
        grid-column-gap: 0px;
        grid-row-gap: 0px;
        position: relative;
        top: -38px;
    }
    .approval-code-parent div {
        margin: auto auto;
    }
    .approval-code-parent p {
        text-align: center;
    }
    .approval-code-parent-link {
        color: #0054b6;
        vertical-align: middle;
        text-decoration: underline;
        cursor: pointer;
    }
    .approval-code-parent input {
        height: 36px;
        width: 242px;
        border-radius: 10px;
        border-style: solid;
        border-color: #afafaf;
        vertical-align: middle;
        text-align: center;
        border-width: 1px;
    }
    .approval-code-parent img {
        vertical-align: middle;
        height: 40px;
        width: 40px;
        padding-left: 8px;
        cursor: pointer;
    }
    .approval-code-parent button {
      height: 28px;
      width: 180px;
      border-radius: 6px;
      border-style: solid;
      border-color: #f38546;
      border-width: 1px;
      background-color: #fe9c57;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
</style>